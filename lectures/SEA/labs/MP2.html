<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Systèmes d’Exploitation – Mini-Projet 2</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc.css" />
  <script src="/usr/share/javascript/mathjax/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<header>
<h1 class="title">Systèmes d’Exploitation – Mini-Projet 2</h1>
</header>
<nav id="TOC">
<ul>
<li><a href="#rendu-du-projet">Rendu du projet</a></li>
<li><a href="#utilisation-de-git">Utilisation de Git</a></li>
<li><a href="#paquets-à-installer">Paquets à installer</a></li>
<li><a href="#notation">Notation</a></li>
<li><a href="#simulateur-dordonnancement">Simulateur d’Ordonnancement</a></li>
<li><a href="#partie-i-ordonnanceurs">Partie I: Ordonnanceurs</a></li>
<li><a href="#partie-ii-métriques">Partie II: Métriques</a></li>
<li><a href="#partie-iii-ordonnancement-temps-réel">Partie III: Ordonnancement Temps-Réel</a></li>
</ul>
</nav>
<p>Dans ce MP vous allez implémenter différents algorithmes d’ordonnancement étudiés en cours: FCFS, RR, SJF, SRTF; et dans la dernière partie des algorithmes d’ordonnancement temps réel: EDF et RM.</p>
<h2 id="rendu-du-projet">Rendu du projet</h2>
<p>La <a href="../index.html">date de rendu</a> est fixée au dimanche 12 avril à 23:59.</p>
<p>Lisez attentivement les instructions de rendu suivantes:</p>
<ul>
<li><p>Vous enverrez un mail à “pablo.oliveira@uvsq.fr” avec pour objet “[SEA] Rendu MP2”. Vous joindrez en PJ à ce mail un fichier nommé “prenom-nom.tar.gz” avec une archive .tar.gz de votre travail. (Si ces instructions ne sont pas strictement respectées un point sera enlevé à votre note.)</p></li>
<li><p>Votre code sera commenté et bien formatté.</p></li>
</ul>
<h2 id="utilisation-de-git">Utilisation de Git</h2>
<p>Pour ce MP il faut travailler dans le repertoire <code>MP2</code>.</p>
<p>Le serveur de rendu git est inaccessible pendant la période de fermeture de l’université. Vous ne pourrez donc faire un <code>push</code> de vos commits sur le serveur de rendu. Vous pouvez éventuellement utiliser votre propre serveur git (eg. serveur privé sur <a href="https://gitlab.com">gitlab.com</a>, mais <strong>merci de ne pas mettre votre travail sur un serveur git publique</strong>.</p>
<h2 id="paquets-à-installer">Paquets à installer</h2>
<p>Pour pouvoir générer le rapport en LaTeX du simulateur il faut installer les paquets avec la commande suivante,</p>
<pre><code>$ sudo apt-get install --no-install-recommends texlive-fonts-recommended
texlive-latex-base texlive-generic-recommended texlive-pstricks
texlive-latex-extra texlive-lang-french</code></pre>
<h2 id="notation">Notation</h2>
<p>Ce MP est noté. Le travail doit être fait individuellement. Vous pouvez discuter avec d’autres camarades des techniques abordés dans ce MP, mais il est strictement interdit de donner la réponse aux exercices.</p>
<h2 id="simulateur-dordonnancement">Simulateur d’Ordonnancement</h2>
<p>Un simulateur d’ordonnancement vous est fourni. Récupérez le à <a href="../scheduler.tar.gz">ici</a>.</p>
<p>Pour le décompresser dans votre répertoire MP2, vous utiliserez les commandes suivantes:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1">    $ <span class="bu">cd</span> MP2/</a>
<a class="sourceLine" id="cb2-2" title="2">    $ <span class="ex">wget</span> https://www.sifflez.org/lectures/SEA/scheduler.tar.gz</a>
<a class="sourceLine" id="cb2-3" title="3">    $ <span class="fu">tar</span> xvf scheduler.tar.gz</a>
<a class="sourceLine" id="cb2-4" title="4">    $ <span class="fu">git</span> add *</a>
<a class="sourceLine" id="cb2-5" title="5">    $ <span class="fu">git</span> commit -m <span class="st">&quot;Simulateur d&#39;ordonnancement fourni&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    $ <span class="fu">git</span> push origin master</a></code></pre></div>
<p>Ce simulateur d’ordonnancement possède plusieurs commandes. La commande <code>make</code> vous permets de compiler le simulateur et <code>make clean</code> d’effacer les fichiers générés.</p>
<p>La commande <code>make simulate_fcfs</code> vous permets de simuler l’ordonnanceur <code>fcfs</code>. Vous pouvez remplacer <code>fcfs</code> par l’ordonnanceur de votre choix (<code>rr</code>, <code>sjf</code> ou <code>srtf</code>). Lorsque vous exécutez <code>make simulate_fcfs</code>, un fichier <code>preview.ps</code> est crée. Il contient les résultats de votre simulation, vous pouvez l’ouvrir avec la commande <code>evince preview.ps</code>.</p>
<p>Enfin, la commande <code>make rapport</code> vous permets de simuler les quatre ordonnanceurs et de générer le fichier final <code>rapport.ps</code>. Une fois que vous aurez terminé le MP n’oubliez pas de lancer cette commande pour vérifier vos résultats.</p>
<h1 id="partie-i-ordonnanceurs">Partie I: Ordonnanceurs</h1>
<ol class="example" type="1">
<li><p>Modifiez le fichier <code>rapport.tex</code> et changez le champ <code>author</code> avec vos noms et prénoms.</p></li>
<li><p>Testez la commande <code>make rapport</code>.</p></li>
</ol>
<p>Le simulateur est composé de plusieurs fichiers:</p>
<ul>
<li><code>sched.h</code>: décrit les différents types utilisés.
<ul>
<li><code>tproc</code>: définit un processus, il comporte un <code>pid</code>, un temps d’activation, une durée d’exécution (<code>length</code>) et un champ <code>remaining</code> pour savoir à tout instant combien de temps il reste à exécuter.</li>
<li><code>tnode</code>: un nœud dans une liste chaînée de processus</li>
<li><code>tlist</code>: une liste chaînée de processus</li>
<li><code>tstats</code>: une structure pour comptabiliser différentes métriques (temps de complétion, attente et réponse).</li>
<li><code>tproc</code>: est un type pointeur de fonctions pour les fonctions d’ordonnancement</li>
<li>un ensemble de fonctions pour manipuler les listes de processus sont également définies</li>
</ul></li>
<li><code>list.c</code>: contient l’implémentation des fonction manipulant les listes de processus
<ul>
<li><code>add</code>: permet d’ajouter un processus en fin de liste</li>
<li><code>del</code>: permet de supprimer un processus</li>
<li>Pour <code>l</code> de type <code>tlist*</code>, <code>l-&gt;first</code> et <code>l-&gt;last</code> permettent d’accéder au premier et dernier éléments de la liste</li>
<li>Pour <code>n</code> de type <code>tnode*</code>, <code>n-&gt;next</code> permet d’accéder à l’élément suivant dans la liste et <code>n-&gt;proc</code> retourne la structure processus.</li>
</ul></li>
<li><code>sched.c</code>: contient la logique du simulateur
<ul>
<li><code>ready</code> est une liste avec les processus prêts et <code>proc</code> contient tous les autres processus</li>
<li><code>main</code>: décode les arguments en ligne de commande et charge la description des tâches depuis le fichier <code>task_description.h</code>. Les tâches dans <code>task_description.h</code> sont exactement celles données en exemple en cours. Au départ <code>main</code> ajoute toutes les tâches dans la liste <code>proc</code>. Puis <code>main</code> appelle <code>simulate</code> pour lancer la simulation.</li>
<li><code>simulate</code>: c’est le cœur du simulateur. La boucle externe gère le temps. À chaque pas de temps, les actions suivantes sont déclenchées:
<ul>
<li>On active les processus dont la date d’activation est atteinte. C’est à dire on les déplace de la liste <code>procs</code> vers la liste <code>ready</code>.</li>
<li>Si des processus sont prêts, on appelle la fonction <code>scheduler</code> (qui pointe vers un des ordonnanceurs <code>rr</code>, <code>fcfs</code>, etc.)</li>
<li>La fonction <code>scheduler</code> choisit un processus qu’elle retourne. Elle écrit également dans <code>delta</code> le nombre d’unités de temps pendant lesquelles le processus sera exécuté.</li>
<li>On augmente donc l’horloge de <code>delta</code>.</li>
<li>Enfin on supprime les tâches completées (dont le champ <code>remaining</code> est à zéro).</li>
</ul></li>
<li><code>randomscheduler</code>: c’est un ordonnanceur exemple</li>
<li><code>fcfs</code>, <code>rr</code>, <code>sjf</code>, <code>srtf</code>: ces fonctions implémentent différents ordonnanceurs. Pour l’instant elles appellent toutes, <code>randomscheduler</code>.</li>
</ul></li>
</ul>
<ol start="3" class="example" type="1">
<li><p>Étudiez le code du simulateur, prenez du temps sur cette question car elle vous aidera pour la suite. Il n’y a rien à rendre pour cette question, mais elle est <em>très</em> importante!</p></li>
<li><p>Décrire le fonctionnement de <code>randomscheduler</code> dans un fichier <code>randomscheduler.txt</code> que vous commiterez dans git.</p></li>
<li><p>Implémentez la fonction <code>fcfs</code>. Vérifiez que vous trouvez le même ordonnancement qu’en cours.</p></li>
<li><p>Implémentez la fonction <code>rr</code>. Vérifiez que vous trouvez le même ordonnancement qu’en cours.</p></li>
<li><p>Implémentez la fonction <code>sjf</code>. Vérifiez que vous trouvez le même ordonnancement qu’en cours.</p></li>
<li><p>Implémentez la fonction <code>srtf</code>. Vérifiez que vous trouvez le même ordonnancement qu’en cours.</p></li>
</ol>
<h1 id="partie-ii-métriques">Partie II: Métriques</h1>
<p>Vous remarquerez que les statistiques dans l’objet <code>stats</code> sont toujours à zéro.</p>
<p>Votre implémentation doit être indépendante de la fonction d’ordonnancement choisie. Elle ne doit donc pas modifier les fonctions <code>fcfs</code>, <code>rr</code>, <code>sjf</code> et <code>srtf</code>. Vous ne devez normalement modifier que la fonction <code>simulate</code>.</p>
<ol start="9" class="example" type="1">
<li><p>Modifiez le simulateur pour comptabiliser le temps total de complétion.</p></li>
<li><p>Modifiez le simulateur pour comptabiliser le temps total de réponse.</p></li>
<li><p>Modifiez le simulateur pour comptabiliser le temps total d’attente.</p></li>
<li><p>Est-ce que les propriétés décrites en cours sont vérifiées ? Écrivez votre réponse dans le fichier <code>proprietes.txt</code> que vous commiterez dans git.</p></li>
</ol>
<h1 id="partie-iii-ordonnancement-temps-réel">Partie III: Ordonnancement Temps-Réel</h1>
<p>Dans cette nous allons étendre le simulateur d’ordonanncement de manière à tester les deux algorithmes d’ordonnancement temps réel étudiés en cours: RM et EDF.</p>
<ol start="13" class="example" type="1">
<li>Rajoutez une nouvelle cible au Makefile pour générer un fichier rapport avec les ordonnanceurs <code>rm</code> et <code>edf</code>,</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode makefile"><code class="sourceCode makefile"><a class="sourceLine" id="cb3-1" title="1"></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="dv">rapport_tr:</span><span class="dt"> rm.tex rm.source edf.tex edf.source</span></a>
<a class="sourceLine" id="cb3-3" title="3">    latex rapport_tr.tex</a>
<a class="sourceLine" id="cb3-4" title="4">    dvips rapport_tr.dvi -f &gt; rapport_tr.ps</a>
<a class="sourceLine" id="cb3-5" title="5">    evince rapport_tr.ps</a></code></pre></div>
<ol start="14" class="example" type="1">
<li>Créez également le fichier <code>rapport_tr.tex</code> avec le contenu ci-dessous, remplacez “Premier Nom et Deuxième Nom” par vos deux noms.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode latex"><code class="sourceCode latex"><a class="sourceLine" id="cb4-1" title="1"><span class="bu">\documentclass</span>{<span class="ex">article</span>}</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="bu">\usepackage</span>[utf8]{<span class="ex">inputenc</span>}</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="bu">\usepackage</span>[T1]{<span class="ex">fontenc</span>}</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="bu">\usepackage</span>[francais]{<span class="ex">babel</span>}</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="bu">\usepackage</span>{<span class="ex">rtsched</span>}</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="bu">\usepackage</span>{<span class="ex">fullpage</span>}</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="bu">\usepackage</span>{<span class="ex">color</span>}</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="bu">\usepackage</span>{<span class="ex">listings</span>}</a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="fu">\author</span>{Premier Nom et Deuxième Nom}</a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="fu">\lstset</span>{ <span class="co">%</span></a>
<a class="sourceLine" id="cb4-13" title="13">language=C, </a>
<a class="sourceLine" id="cb4-14" title="14">belowcaptionskip=1<span class="fu">\baselineskip</span>,</a>
<a class="sourceLine" id="cb4-15" title="15">breaklines=true,</a>
<a class="sourceLine" id="cb4-16" title="16">frame=L,</a>
<a class="sourceLine" id="cb4-17" title="17">xleftmargin=<span class="fu">\parindent</span>,</a>
<a class="sourceLine" id="cb4-18" title="18">language=C,</a>
<a class="sourceLine" id="cb4-19" title="19">showstringspaces=false,</a>
<a class="sourceLine" id="cb4-20" title="20">basicstyle=<span class="fu">\ttfamily</span>,</a>
<a class="sourceLine" id="cb4-21" title="21">keywordstyle=<span class="fu">\bfseries\color</span>{green!40!black},</a>
<a class="sourceLine" id="cb4-22" title="22">commentstyle=<span class="fu">\itshape\color</span>{purple!40!black},</a>
<a class="sourceLine" id="cb4-23" title="23">identifierstyle=<span class="fu">\color</span>{black},</a>
<a class="sourceLine" id="cb4-24" title="24">stringstyle=<span class="fu">\color</span>{orange},</a>
<a class="sourceLine" id="cb4-25" title="25">numbers=left,</a>
<a class="sourceLine" id="cb4-26" title="26">}</a>
<a class="sourceLine" id="cb4-27" title="27"></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="fu">\title</span>{T7: Ordonnancement TR}</a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="kw">\begin</span>{<span class="ex">document</span>}</a>
<a class="sourceLine" id="cb4-31" title="31"><span class="fu">\maketitle</span></a>
<a class="sourceLine" id="cb4-32" title="32"></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="kw">\section</span>{RM}</a>
<a class="sourceLine" id="cb4-34" title="34"><span class="fu">\input</span>{rm.tex}</a>
<a class="sourceLine" id="cb4-35" title="35"><span class="fu">\lstinputlisting</span>{rm.source}</a>
<a class="sourceLine" id="cb4-36" title="36"><span class="kw">\section</span>{EDF}</a>
<a class="sourceLine" id="cb4-37" title="37"><span class="fu">\input</span>{edf.tex}</a>
<a class="sourceLine" id="cb4-38" title="38"><span class="fu">\lstinputlisting</span>{edf.source}</a>
<a class="sourceLine" id="cb4-39" title="39"></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="kw">\end</span>{<span class="ex">document</span>}</a></code></pre></div>
<p>On travaillera avec des tâches périodiques, dont l’échéance est égale à la période.</p>
<ol start="15" class="example" type="1">
<li><p>Pour gérer des tâches temps réel, nous allons modifier la structure <code>tproc</code> de manière à rajouter un champ représentant la periode de chaque tâche. Faites les modifications nécessaires dans le code de manière à que chaque tâche ait un champ <code>period</code>.</p>
<ul>
<li>Si ce champ vaut 0, la tâche est apériodique.</li>
<li>Si ce champ vaut <span class="math inline">\(t \neq 0\)</span>, alors la tâche est périodique de période <span class="math inline">\(t\)</span>.</li>
</ul></li>
</ol>
<p>Pour la suite, les algorithmes RM et EDF ne marcheront que sur des tâches périodiques. Néanmoins, lorsque vous faites des modifications dans le simulateur, vous devrez vous assurer que le code marche encore pour les tâches apériodiques sur les autres ordonnanceurs.</p>
<ol start="16" class="example" type="1">
<li>Modifiez le fichier <code>task_description.h</code>, de manière à simuler le système de tâches suivant:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb5-1" title="1"><span class="dt">int</span> max_time = <span class="dv">40</span>;</a>
<a class="sourceLine" id="cb5-2" title="2">tproc tasks[] = {</a>
<a class="sourceLine" id="cb5-3" title="3">     <span class="co">//pid  //activation  //length  //remaining  //period</span></a>
<a class="sourceLine" id="cb5-4" title="4">    {<span class="dv">1</span>,     <span class="dv">0</span>,            <span class="dv">1</span>,        <span class="dv">1</span>,           <span class="dv">3</span>       },</a>
<a class="sourceLine" id="cb5-5" title="5">    {<span class="dv">2</span>,     <span class="dv">0</span>,            <span class="dv">1</span>,        <span class="dv">1</span>,           <span class="dv">4</span>       },</a>
<a class="sourceLine" id="cb5-6" title="6">    {<span class="dv">3</span>,     <span class="dv">0</span>,            <span class="dv">2</span>,        <span class="dv">2</span>,           <span class="dv">6</span>       },</a>
<a class="sourceLine" id="cb5-7" title="7">};</a></code></pre></div>
<ol start="17" class="example" type="1">
<li><p>Modifiez la fonction <code>simulate</code> de manière à gérer les tâches périodiques. Chaque fois qu’une tâche finit, si elle est périodique il faut la redémarrer. Pour cela, il faudra mettre à jour ses champs <code>activation</code> et <code>remaining</code> et la rajouter à la liste des tâches.</p></li>
<li><p>Implémentez l’ordonnanceur EDF vu en cours.</p></li>
<li><p>Implémentez l’ordonnanceur RM vu en cours.</p></li>
<li><p>Testez les différents systèmes de tâches présentés en cours. Obtenez vous les mêmes résultats que moi ?</p></li>
<li><p>Modifiez la fonction simulate de manière à afficher en rouge l’exécution d’une tâche qui ne satisfait pas son échéance. Pour modifier la couleur d’une exécution de tâche vous pouvez remplacer</p>
<pre><code>    \\TaskExecution{%d}{%d}{%d}</code></pre>
<p>par</p>
<pre><code>    \\TaskExecution[color=red]{%d}{%d}{%d}</code></pre></li>
<li><p>Proposez et testez un système de tâche qui est ordonnançable avec EDF et qui n’est pas ordonnançable avec RM.</p></li>
</ol>
</body>
</html>
