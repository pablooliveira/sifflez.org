<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Lab 0 - Mise en Place et apprentissage de Git</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../pandoc.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">Lab 0 - Mise en Place et apprentissage de Git</h1>
</header>
<nav id="TOC">
<ul>
<li><a href="#setup">Setup</a><ul>
<li><a href="#présentation-de-git">Présentation de Git</a></li>
<li><a href="#création-dun-compte-sur-tahiti.prism.uvsq.fr">Création d’un compte sur tahiti.prism.uvsq.fr</a></li>
<li><a href="#initialization-du-dépôt">Initialization du dépôt</a></li>
<li><a href="#création-dun-dépôt-git-et-ajout-de-fichiers">Création d’un dépôt git et ajout de fichiers</a></li>
<li><a href="#enregistrer-des-modifications-sous-git">Enregistrer des modifications sous git</a></li>
<li><a href="#visiter-une-version-précédente">Visiter une version précédente</a></li>
<li><a href="#annuler-les-changements-non-commités">Annuler les changements non commités</a></li>
<li><a href="#revenir-à-une-ancienne-version-définitivement">Revenir à une ancienne version définitivement</a></li>
<li><a href="#partager-votre-code-avec-les-autres">Partager votre code avec les autres</a></li>
</ul></li>
</ul>
</nav>
<h2 id="setup">Setup</h2>
<p>Pour tous les TPs de compilation on utilisera <a href="http://git-scm.com">git</a>. Un dépôt git contient un projet en cours. Chaque dépôt git peut-être cloné sur différents ordinateurs locaux ou distants.</p>
<p>Ce document est sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/2.0/">CC by-nc-sa</a>. Une partie de ce TP est inspirée du cours <em>Gerez vos codes source avec git</em> de Mathieu Nebra.</p>
<h3 id="présentation-de-git">Présentation de Git</h3>
<p>Git est capable de suivre l’évolution d’un fichier texte ligne de code par ligne de code et garde toutes les versions et tous les changements de votre code. Mais Git n’est pas seulement un outil de backup (sauvegarde), il propose de nombreuses fonctionnalités supplémentaires, par exemple</p>
<ul>
<li><p>Git retient qui a effectué chaque modification de chaque fichier et pourquoi.</p></li>
<li><p>Si deux personnes travaillent simultanément sur un même fichier, Git est capables d’assembler (de fusionner) leurs modifications et d’éviter que le travail d’une de ces personnes ne soit écrasé.</p></li>
</ul>
<p>Git est un logiciel de gestion de version “distribué”. Chacun des développeurs participant à un même projet possède son propre <em>dépot git</em>. Les développeurs peuvent s’échanger des versions et des modifications (commits) dans un modèle pair à pair. Souvent un <em>dépot</em> central est crée sur un serveur. Le dépôt central sert de point de rencontre et facilite les échanges entre développeurs. Le serveur connaît l’historique des modifications et permet l’échange d’informations entre les développeurs, qui eux possèdent également l’historique des modifications.</p>
<p>C’est dans ce dernier mode que nous allons fonctionner dans ce module.</p>
<h3 id="création-dun-compte-sur-tahiti.prism.uvsq.fr">Création d’un compte sur tahiti.prism.uvsq.fr</h3>
<p>Pour sauvegarder et rendre votre travail nous allons utiliser le serveur gitlab <a href="http://tahiti.prism.uvsq.fr">tahiti.prism.uvsq.fr</a>.</p>
<ol class="example" type="1">
<li><p>Normalement vous avez reçu un mail sur votre adresse <code>@ens.uvsq.fr</code> vous invitant à créer un compte sur <a href="http://tahiti.prism.uvsq.fr">tahiti.prism.uvsq.fr</a>. Attention il est impératif d’utiliser cette adresse mail et pas une adresse personnelle lors de la création du compte.</p></li>
<li><p>Lorsque vous vous connectez sur le site, vous pourrez voir vos projets. Un projet <code>compil/prenom-nom</code> a déjà été crée pour vous.</p></li>
<li><p>(optionnel) Si vous souhaitez pouvoir cloner et pusher sur votre dépôt sans taper votre password à chaque fois, rajoutez une clé ssh sur votre compte. Cliquez sur le menu déroulant en haut à droite, choisissez “Settings”, puis sur la barre à droite choisissez “SSH Keys”.</p></li>
</ol>
<h3 id="initialization-du-dépôt">Initialization du dépôt</h3>
<ol start="4" class="example" type="1">
<li><p>Pour pouvoir commencer à travailler sur votre dépôt git, il va falloir le cloner. Pour cela allez sur <a href="http://tahiti.prism.uvsq.fr">tahiti.prism.uvsq.fr</a> et récupérez l’adresse du dépôt. D’abord choisissez le type d’adresse HTTP ou SSH sur le menu déroulant au centre de l’interface (ne choisissez SSH que si vous avez rajouté une clé SSH sur votre profil). Puis copiez l’adresse qui se trouve juste à côté.</p></li>
<li><p>Allez maintenant sur le terminal et tapez les commande suivantes:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1">    <span class="co"># Attention: les commandes seront différentes pour vous selon votre nom et prénom :-)</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">    <span class="co"># clonez le dépôt</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    $ <span class="fu">git</span> clone http://tahiti.prism.uvsq.fr/compil/pablo-oliveira.git </a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="ex">warning</span>: You appear to have cloned an empty repository.</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="ex">Checking</span> connectivity... done.</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="co"># Allez à l&#39;intérieur du dépôt cloné en local</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">    $ <span class="bu">cd</span> pablo-oliveira/</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">    <span class="co"># Créez maintenant un répertoire lab0 dans votre dépôt</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">    $ <span class="fu">mkdir</span> lab0</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">    $ <span class="bu">cd</span> lab0</a></code></pre></div>
<p>Si vous souhaitez cloner ce dépôt sur d’autres machines; la procédure est la même. Les commandes git vous permettent de synchroniser les différentes instances de dépôt entre elles.</p>
<p>Dans la suite du TP, vous travaillerez sur le répertoire <code>lab0</code> que vous venez de créer. À chaque question où l’on vous demande de créer un modifier des fichiers, vous <em>committerez</em> vos modifications.</p>
<h3 id="création-dun-dépôt-git-et-ajout-de-fichiers">Création d’un dépôt git et ajout de fichiers</h3>
<p>Tout d’abord il faut configurer git avec vos informations personnelles</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1">$ <span class="fu">git</span> config --global user.name <span class="st">&quot;Pablo Oliveira&quot;</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">$ <span class="fu">git</span> config --global user.email pablo.oliveira@uvsq.fr</a></code></pre></div>
<p>Maintenant écrivez un programme <code>test.cc</code> pour afficher “Hello World!” sur la sortie standard et un fichier Makefile pour le compiler avec <code>clang++-3.9</code>. Écrivez votre programme en C++.</p>
<p>Pour commiter les fichier il faut d’abord les ajouter dans git avec</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1">$ <span class="fu">git</span> add Makefile test.cc</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">$ <span class="fu">git</span> status</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="ex">On</span> branch master</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="ex">Initial</span> commit</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="ex">Changes</span> to be committed:</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="kw">(</span><span class="ex">use</span> <span class="st">&quot;git rm --cached &lt;file&gt;...&quot;</span> to unstage<span class="kw">)</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    <span class="ex">new</span> file:   Makefile</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    <span class="ex">new</span> file:   test.cc</a></code></pre></div>
<p>La commande <code>git status</code> vous permet de voir ce qui est nouveau depuis la dernière sauvegarde (ou commit) dans le dépôt. Maintenant <code>git status</code> nous indique que les deux fichiers sont prets à être committés.</p>
<p>La commande <code>git commit</code> ouvre un editeur qui vous permet de taper un message indiquant à quoi correspondent les fichier ajoutés ou modifiés.</p>
<p>Pour les messages de commit utilise la convention suivante,</p>
<ul>
<li><p>la première ligne doit contenir un message court et informatif qui résume vos modifications</p></li>
<li><p>la deuxième ligne doit être vide</p></li>
<li><p>à partir de la troisième ligne vous pouvez décrire le détail de vos changements</p></li>
</ul>
<p>Par exemple:</p>
<pre><code>    lab0 (exo1): write a hello world program

    test.cc prints &quot;Hello World!&quot; to the standard
    output. Also added a makefile.</code></pre>
<p><a href="http://ensiwiki.ensimag.fr/index.php/%C3%89crire_de_bons_messages_de_commit_avec_Git">Voici une bonne référence</a> sur la manière de rédiger vos messages de commit.</p>
<h3 id="enregistrer-des-modifications-sous-git">Enregistrer des modifications sous git</h3>
<p>Maintenant vous pouvez modifier votre programme. Faites en sorte que le programme fasse une faute de segmentation. Comment faire ? Soyez créatifs ☺</p>
<p>Puis tapez <code>git diff</code> pour voir vos changements.</p>
<p>Maintenant commitez vos changements avec <code>git add test.cc</code> suivi de <code>git commit</code>.</p>
<p>Vous pouvez consulter le journal des modifications avec <code>git log</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1">$ <span class="fu">git</span> log</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ex">commit</span> 66ea53ab301045fc5a990fac3672f842dc75b2e8</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="ex">Author</span>: Pablo Oliveira <span class="op">&lt;</span>pablo.oliveira@uvsq.fr<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="ex">Date</span>:   Thu Sep 13 22:59:15 2018 +0200</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="ex">Harmless</span> modification that makes the program segfault</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="ex">commit</span> b35c2b6551d4b3738170637634702ed4d82aa501</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="ex">Author</span>: Pablo Oliveira <span class="op">&lt;</span>pablo.oliveira@uvsq.fr<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="ex">Date</span>:   Thu Sep 13 22:55:05 2018 +0200</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">    <span class="ex">lab0</span> (exo1)<span class="bu">:</span> write a hello world program</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    <span class="ex">test.cc</span> prints <span class="st">&quot;Hello World!&quot;</span> to the standard</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">    <span class="ex">output.</span> Also added a makefile.</a></code></pre></div>
<p>Chaque commit est suivi d’un code hexadecimal unique qui l’identifie. Vous pouvez visualiser les changements entre deux versions avec <code>git diff b35c2b6 66ea53a</code>, ce n’est pas la peine de taper tous les chiffres, les premiers suffisent (sauf en cas de conflit). Essayez !</p>
<p>Les différentes versions forment un “fil” ou <strong>branche</strong> de versions. Dans git la branche principale s’appelle d’habitude <code>master</code>.</p>
<p>Git permet de travailler sur plusieurs branches en même temps, mais cela dépasse le cadre de cette introduction.</p>
<h3 id="visiter-une-version-précédente">Visiter une version précédente</h3>
<p>Git sauvegarde toutes les versions et permets de revenir à une version précédente.</p>
<p>Par exemple pour revenir à la version de base vous pouvez taper:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"> $ <span class="fu">git</span> checkout b35c2b6</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="ex">You</span> are in <span class="st">&#39;detached HEAD&#39;</span> state. You can look around, make experimental</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="ex">changes</span> and commit them, and you can discard any commits you make in this</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="ex">state</span> without impacting any branches by performing another checkout.</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="ex">If</span> you want to create a new branch to retain commits you create, you may</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="kw">do</span> <span class="ex">so</span> (now or later) <span class="ex">by</span> using -b with the checkout command again. Example:</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="fu">git</span> checkout -b new_branch_name</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="ex">HEAD</span> is now at b35c2b6... Initial commit: Hello World program</a></code></pre></div>
<p><code>git</code> nous previens que nous ne sommes plus en tête de la branche master ce qui est normal vu que nous sommes revenus à une vieille version.</p>
<p>Pour revenir à la dernière version vous pouvez taper:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1">$ <span class="fu">git</span> checkout master</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="ex">Previous</span> HEAD position was b35c2b6... Initial commit: Hello World program</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="ex">Switched</span> to branch <span class="st">&#39;master&#39;</span></a></code></pre></div>
<h3 id="annuler-les-changements-non-commités">Annuler les changements non commités</h3>
<p>Parfois vous avez fait des modifications sur un fichier et vous voulez les annuler et revenir à la dernière version commitée.</p>
<p>Pour cela vous pouvez utiliser <code>git checkout</code> comme sur l’exemple suivant</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1">$ <span class="fu">rm</span> test.cc</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co"># Ooops j&#39;ai effacé test.cc</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">$ <span class="fu">git</span> checkout test.cc</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co"># tout va bien !</span></a></code></pre></div>
<p>Essayez.</p>
<h3 id="revenir-à-une-ancienne-version-définitivement">Revenir à une ancienne version définitivement</h3>
<p>Parfois on veut revenir à une ancienne version pour de bon. La commande suivante vous le permet:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" data-line-number="1">$ <span class="fu">git</span> reset --hard b35c2b6</a></code></pre></div>
<p>Essayez de revenir à la version sans segfault.</p>
<h3 id="partager-votre-code-avec-les-autres">Partager votre code avec les autres</h3>
<p>Pour partager votre code avec un autre dépot, <code>git</code> propose deux commandes:</p>
<ul>
<li><code>push</code> qui permet d’envoyer (“pousser”) votre code vers un autre dépot</li>
<li><code>pull</code> qui permet de récupérer (“tirer”) les changements depuis un un autre dépot</li>
</ul>
<p>Comme vous avez cloné votre dépôt depuis tahiti.prism.uvsq.fr; ce serveur est déja configuré comme serveur push par défaut.</p>
<p>Pour envoyer vos changements faites:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" data-line-number="1">    $ <span class="fu">git</span> push origin master</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="ex">Counting</span> objects: 3, done.</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="ex">Delta</span> compression using up to 8 threads.</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    <span class="ex">Compressing</span> objects: 100% (2/2), <span class="kw">done</span><span class="ex">.</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">    <span class="ex">Writing</span> objects: 100% (3/3), <span class="ex">271</span> bytes <span class="kw">|</span> <span class="ex">0</span> bytes/s, done.</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    <span class="ex">Total</span> 3 (delta 0), <span class="ex">reused</span> 0 (delta 0)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    <span class="ex">To</span> http://pablo-oliveira@tahiti.prism.uvsq.fr/compil/pablo-oliveira.git</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    <span class="ex">*</span> [new branch]      master -<span class="op">&gt;</span> master</a></code></pre></div>
</body>
</html>
